<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AI Legal Assistant</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            font-size: 18px;
            margin: 10px;
        }
        pre {
            font-family: Arial, sans-serif;
            font-size: 14px;
            white-space: pre-wrap;
        }
        .response {
            border: 1px solid #ccc;
            padding: 10px;
            margin-bottom: 10px;
        }
        .error {
            color: red;
        }
        .top-right-image {
            position: absolute;
            top: 30px;
            right: 880px;
            width: 380px;
        }
        .api-key-container {
            margin-top: 10px;
        }
        .examples-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .example-box {
            border: 1px solid #ccc;
            padding: 10px;
            width: calc(50% - 10px); 
            box-sizing: border-box;
            margin-bottom: 10px;
        }
        .clickable-dots {
            font-weight: bold;
            cursor: pointer;
        }
        .source-link {
            font-size: smaller;
            font-style: italic;
            margin-top: 5px;
        }
        .source-link a {
            color: black;  
            text-decoration: none;
        }
        .source-link a:hover {
            text-decoration: underline;
        }
        .more-content {
            display: none;
        }
    </style>
</head>
<body>

    <img src="https://www.eitmanufacturing.eu/wp-content/uploads/2021/10/JSI-Logo-002.jpg" alt="JSI Logo" class="top-right-image">

    <h1>AI Legal Assistant</h1>

    <!-- Form submission -->
    <form action="/query" method="post">
        <div>
            <label for="query" style="margin-bottom: -20px; display: block;">
                Provide details about your legal matter involving artificial intelligence:
            </label><br>
            <textarea id="query" name="query" rows="10" cols="90" required style="margin-top: 3px;"></textarea><br><br>
        </div>

        <!-- API Key input -->
        <div class="api-key-container">
            <label for="api_key">API Key:</label><br>
            <input type="password" id="api_key" name="api_key" size="97" required><br><br>
        </div>

        <button type="submit" style="padding: 5px 5px; font-size: 15px;">Submit</button>

        {% if not user_query %}
        <!-- Section with query examples (Visible only when no query is submitted) -->
        <div>
            <h2>Example Queries:</h2>
            <div class="examples-container">
                {% for example in examples %}
                <div class="example-box">
                    <p>
                        {{ example.short }}
                        {% if example.rest %}
                        <span id="dots-{{ loop.index }}" class="clickable-dots" onclick="toggleExample('{{ loop.index }}')">...</span>
                        <span id="more-{{ loop.index }}" style="display: none;">
                            <span id="text-{{ loop.index }}">{{ example.rest }}</span>
                            <p class="source-link">
                                <a href="{{ example.source }}" id="source-{{ loop.index }}" target="_blank" style="display:none;">Source</a>
                            </p>
                        </span>
                        {% endif %}
                    </p>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}
    </form>

    {% if error_message %}
        <div class="error">
            <p>{{ error_message }}</p>
        </div>
    {% endif %}

    {% if user_query %}
        <h2>Submitted Query:</h2>
        <p>{{ user_query }}</p>

        <!-- Constructed Prompt Section (Visible only after a query is submitted) -->
        <h2>Constructed Prompt:</h2>
        <pre>{{ prompt }}</pre>

        <h2>Responses from the Assistant:</h2>
        {% for response in responses %}
            <div class="response">
                <pre>{{ response }}</pre>
            </div>
        {% endfor %}
    {% endif %}

    <script>
    function toggleExample(id) {
        var dots = document.getElementById("dots-" + id);
        var moreText = document.getElementById("more-" + id);
        var sourceLink = document.getElementById("source-" + id);

        if (dots.style.display === "none") {
            dots.style.display = "inline";
            moreText.style.display = "none";
            sourceLink.style.display = "none"; 
        } else {
            dots.style.display = "none";
            moreText.style.display = "inline";
            sourceLink.style.display = "inline";  
        }
    }
    </script>
</body>
</html>
